<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Virtual Advisor Plugin - Test</title>
    <style>
    </style>
</head>
<body>

    <script type="module">
        import { VirtualAdvisor } from '../src/index.js';
        
        // Global variables
        let advisor = null;
        let isPluginVisible = true;

        // Initialize plugin when page loads
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                advisor = new VirtualAdvisor({
                    apiUrl: 'http://localhost:8001/api', // Endpoint API
                    position: 'bottom-right',
                    ui: {
                        theme: 'light',
                        animations: true,
                        showVisualizer: true
                    }
                });
                
                // Sprawdź uprawnienia mikrofonu
                console.log('Sprawdzanie uprawnień mikrofonu...');
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                    console.log('✅ Mikrofon dostępny');
                    stream.getTracks().forEach(track => track.stop());
                } catch (error) {
                    console.error('❌ Błąd mikrofonu:', error);
                    alert('Błąd: Brak dostępu do mikrofonu. Sprawdź ustawienia przeglądarki.');
                }
                
                // Sprawdź czy MediaRecorder jest obsługiwany
                if (!window.MediaRecorder) {
                    console.error('❌ MediaRecorder nie jest obsługiwany');
                    alert('Błąd: Przeglądarka nie obsługuje nagrywania audio.');
                } else {
                    console.log('✅ MediaRecorder obsługiwany');
                }
                
                console.log('Plugin zainicjalizowany');
                
            } catch (error) {
                console.error('Błąd inicjalizacji:', error);
                alert('Błąd inicjalizacji: ' + error.message);
            }
        });

    </script>
</body>
</html>